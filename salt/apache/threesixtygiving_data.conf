# vi: ft=apache
<VirtualHost *:80>
    ServerName data.threesixtygiving.org
    ServerAlias threesixtygiving_data.*.default.opendataservices.uk0.bigv.io
    {% set documentroot='/home/threesixtygiving_data/web/' %}
    DocumentRoot {{ documentroot }}

    <Directory {{ documentroot }}>
        Require all granted
    </Directory>

    ProxyPass /data.json {{ pillar.threesixtygiving.salesforce_api_backend }}
    # Redirect everything but /sites/..., and the proxied pages to GitHub pages
    RedirectMatch ^/(?!sites)(.*)$ http://threesixtygiving.github.io/getdata/
</VirtualHost>
